<?php
global $semaphore;

include_once 'common.php';
include_once 'php-svg.php';

global $border_draw_function;
$border_draw_function = 'lib_border_draw_labyrinth';

function lib_border_draw_labyrinth() {
  $r = 35;
  $w = CARD_BLEED_W - CARD_SAFE_W;
  $h = CARD_BLEED_H - CARD_SAFE_H;
  $x = $w / 2;
  $y = $h / 2;
  $a1 = 'fill="#FFF" stroke="none"';
  $a2 = 'stroke="#FFF" stroke-width="2" fill="none"';

  print svg_attrs(svg_rounded_corner_mask($x, $y, $r, 1), $a1);
  print svg_attrs(svg_rounded_corner_mask($x + CARD_SAFE_W - $r, $y, $r, 2), $a1);
  print svg_attrs(svg_rounded_corner_mask($x, $y + CARD_SAFE_H - $r, $r, 3), $a1);
  print svg_attrs(svg_rounded_corner_mask($x + CARD_SAFE_W - $r, $y + CARD_SAFE_H - $r, $r, 4), $a1);
  print svg_attrs(svg_rect($x, $y, CARD_SAFE_W, CARD_SAFE_H, $r), $a2);
}

function lib_validate_labyrinth($card) {
  return ($card >= 1) && ($card <= 4);
}

function lib_comment_labyrinth($card = 1) {
  echo "Labyrinth style backs, card {$card}.";
}

function lib_style_labyrinth($card = 1) {
  switch ($card) {
    case 2:  $c = COLOR1; break;
    case 3:  $c = COLOR2; break;
    case 4:  $c = "#000"; break; // black
    default: $c = COLOR4; break;
  }
?>
  .cf0 { fill: #FFFE; }
  .cf1 { fill: <?= $c ?>; }
  .cs1 { stroke: <?= $c ?>; }
<?php
}

function lib_defs_labyrinth($card = 1) {
?>
<g id="b" class="cf1" stroke="none">
  <polygon points="4.15389807 146.08611 4.153 150 1.475 150 1.47593112 146.08611" />
  <polygon points="14.8657603 146.08611 14.865 150 12.187 150 12.1877961 146.08611" />
  <polygon points="52.3572865 119.306416 52.3572865 135.377555 65.7471157 135.374212 65.7471157 124.662347 73.7810165 124.662347 73.7810165 146.08611 97.8827107 146.08611 97.8827107 124.662347 100.560675 124.662347 100.560675 148.764044 60.3911846 148.764044 60.3911846 140.730193 68.4250826 140.730193 68.4250826 143.411481 63.0691515 143.411481 63.0691515 146.08611 71.1030496 146.08611 71.1030496 127.343657 68.4250826 127.343657 68.4250826 138.052179 57.7132176 138.055519 57.713 150 55.035 150 55.0352534 138.055519 52.3572865 138.055519 52.3572865 143.411481 22.8996584 143.411481 22.8996584 140.730193 49.6793195 140.730193 49.6793195 119.306416" />
  <polygon points="127.340339 108.594656 127.340339 124.66569 140.730168 124.662347 140.730168 113.950482 148.764077 113.950482 148.764077 132.696245 116.628474 132.699588 116.628474 138.052179 113.950507 138.052179 113.950507 130.018281 146.086088 130.018281 146.086088 116.631792 143.408135 116.631792 143.408135 127.340314 111.272543 127.343657 111.272543 140.730193 132.69627 140.730193 132.69627 143.411481 116.628474 143.411481 116.628 150 113.95 150 113.950507 143.411481 108.594576 143.411481 108.594576 127.343657 105.916609 127.343657 105.916609 146.08611 111.272543 146.08611 111.272543 148.764044 103.238645 148.764044 103.238645 124.662347 124.662372 124.662347 124.662372 108.594656" />
  <polygon points="143.408135 146.08611 143.408 150 140.73 150 140.730168 146.08611" />
  <polygon points="148.764077 140.730193 148.764 150 146.086 150 146.086088 143.411481 140.730168 143.411481 140.730168 140.730193" />
  <polygon points="9.50982919 113.950482 9.50982919 140.730193 20.2216942 140.730193 20.2216942 146.08611 52.3572865 146.08611 52.3572865 148.764044 17.5437273 148.764044 17.5437273 143.411481 9.50982919 143.411481 9.50982919 148.764044 6.83186225 148.764044 6.83186225 143.411481 0 143.411 0 140.73 6.83186225 140.730193 6.83186225 113.950482" />
  <polygon points="150 135.374 150 138.055 138.052204 138.055519 138.052204 148.764044 119.306441 148.764044 119.306441 146.08611 135.374237 146.08611 135.374237 138.055519 119.306441 138.052179 119.306441 135.374212" />
  <polygon points="127.340339 33.6115179 127.340339 38.967449 130.018303 38.967449 130.018303 33.6115179 148.764077 33.6115179 148.764077 36.289482 138.052204 36.289482 138.052204 41.6454132 135.374237 41.6454132 135.374237 36.289482 132.69627 36.289482 132.69627 44.3233801 138.052204 44.3233801 138.052204 47.0013443 132.69627 47.0013443 132.69627 60.3911735 135.374237 60.3911735 135.374237 49.6793112 140.730168 49.6793112 140.730168 38.967449 150 38.967 150 41.645 143.408135 41.6454132 143.408135 52.3572754 138.052204 52.3572754 138.052204 60.3911735 143.408135 60.3911735 143.408135 63.0691376 132.69627 63.0691376 132.69627 71.1030357 140.730168 71.1030357 140.730168 68.4250688 135.374237 68.4250688 135.374237 65.7471046 146.086088 65.7471046 146.086088 60.3911735 148.764077 60.3911735 148.764077 68.4250688 143.408135 68.4250688 143.408135 87.1708263 146.086088 87.1708263 146.086088 76.4589641 148.764077 76.4589641 148.764077 100.560656 138.052204 100.560656 138.052204 121.984383 130.018303 121.984383 130.018303 105.916617 121.984405 105.916617 121.984405 113.950515 119.306441 113.950515 119.306441 105.916617 116.628474 105.916617 116.628474 119.306446 119.306441 119.306446 119.306441 116.631803 121.984405 116.631803 121.984405 121.984383 113.950507 121.984383 113.950507 103.23862 132.69627 103.23862 132.69627 119.309759 135.374237 119.306416 135.374237 100.560656 111.272543 100.560656 111.272543 121.984413 95.2047438 121.984413 95.2047438 143.411481 87.1708457 143.411481 87.1708457 135.374212 89.8488127 135.374212 89.8488127 140.730193 92.5267768 140.730193 92.5267768 121.984413 89.8488127 121.984413 89.8488127 132.696278 87.1708457 132.696245 87.1708457 119.306416 108.594576 119.306446 108.594576 116.631803 84.4928788 116.631792 84.4928788 143.411481 81.8149146 143.411481 81.8149146 116.631792 57.7132176 116.631792 57.7132176 130.021621 60.3911846 130.018281 60.3911846 119.306416 79.1369476 119.306416 79.1369476 143.411481 76.4589807 143.411481 76.4589807 121.987723 63.0691515 121.987723 63.0691515 132.696245 55.0352534 132.696245 55.0352534 116.631792 49.6793195 116.628449 49.6793195 108.594656 55.0352534 108.594656 55.0352534 92.5267574 57.7132176 92.5267574 57.7132176 103.23862 60.3911846 103.23862 60.3911846 89.8487933 44.3233884 89.8487933 44.3233884 87.1708263 60.3911846 87.1708263 60.3911846 81.8148952 87.1708457 81.8148952 87.1708457 79.136931 55.0352534 79.136931 55.0352534 73.7809999 52.3572865 73.7809999 52.3572865 81.8148952 57.7132176 81.8148952 57.7132176 84.4928621 41.6454215 84.4928621 41.6454215 92.5267574 52.3572865 92.5267574 52.3572865 105.916584 47.0013554 105.916584 47.0013554 138.052179 44.3233884 138.052179 44.3233884 111.275858 36.2894904 111.275858 36.2894904 135.377555 38.9674573 135.374212 38.9674573 113.950482 41.6454215 113.950482 41.6454215 138.052179 17.5437273 138.052179 17.5437273 132.699588 14.8657603 132.699588 14.8657603 138.052179 12.1877961 138.052179 12.1877961 103.23862 14.8657603 103.23862 14.8657603 130.021621 20.2216942 130.018281 20.2216942 135.377555 33.6115234 135.374212 33.6115234 108.594656 44.3233884 108.594656 44.3233884 103.23862 49.6793195 103.23862 49.6793195 95.2047244 38.9674573 95.2047244 38.9674573 81.8148952 49.6793195 81.8148952 49.6793195 71.1030357 57.7132176 71.1030357 57.7132176 76.4589641 89.8488127 76.4589641 89.8488127 84.4928621 63.0691515 84.4928621 63.0691515 111.272518 60.3911846 111.272518 60.3911846 105.916584 57.7132176 105.916584 57.7132176 111.272518 52.3572865 111.275858 52.3572865 113.953825 108.594576 113.950482 108.594576 92.5267574 111.272543 92.5267574 111.272543 97.8826886 113.950507 97.8826886 113.950507 84.4928621 111.272543 84.4928621 111.272543 89.8487933 108.594576 89.8487933 108.594576 84.4928621 103.238645 84.4928621 103.238645 81.8148952 116.628474 81.8148952 116.628474 97.8826886 146.086088 97.8826886 146.086088 89.8487933 140.730168 89.8487933 140.730168 73.7809999 130.018303 73.7809999 130.018303 41.6454132 127.340339 41.6454132 127.340339 44.3233801 124.662372 44.3233801 124.662372 41.6454132 121.984405 41.6454132 121.984405 52.3572754 119.306441 52.3572754 119.306441 38.967449 124.662372 38.967449 124.662372 36.289482 116.628474 36.289482 116.628474 52.3572754 100.560675 52.3572754 100.560675 55.0352424 124.662372 55.0352424 124.662372 47.0013443 127.340339 47.0013443 127.340339 57.7132065 97.8827107 57.7132065 97.8827107 52.3573114 95.2047438 52.3573114 95.2047438 57.7132426 92.5267768 57.7132065 92.5267768 49.6793112 113.950507 49.6793112 113.950507 33.6115179" />
  <polygon points="9.50982919 76.4589641 9.50982919 111.272518 4.15389807 111.275858 4.15389807 138.052179 1.47593112 138.052179 1.47593112 103.23862 4.15389807 103.23862 4.15389807 108.594656 6.83186225 108.594656 6.83186225 100.560656 0 100.56 0 97.882 6.83186225 97.8826886 6.83186225 79.1369671 4.15389807 79.1369671 4.15389807 95.2047244 1.47593112 95.2047244 1.47593112 76.4589641" />
  <polygon points="0 71.103 14.8657603 71.1030357 14.8657603 97.8826886 20.2216942 97.8826886 20.2216942 103.23862 41.6454215 103.23862 41.6454215 105.916584 30.9335592 105.916584 30.9335592 132.696245 28.2555923 132.696245 28.2555923 105.916584 20.2216942 105.916584 20.2216942 124.662425 22.8996584 124.662425 22.8996584 108.594656 25.5776253 108.594656 25.5776253 132.696245 22.8996584 132.696245 22.8996584 127.343657 17.5437273 127.340314 17.5437273 100.560656 12.1877961 100.560656 12.1877961 73.7809999 0 73.78" />
  <polygon points="73.7810165 6.83186225 73.7810165 14.8657575 68.4250826 14.8657575 68.4250826 22.8996556 84.4928788 22.8996556 84.4928788 33.6115179 89.8488127 33.6115179 89.8488127 44.3233801 97.8827107 44.3233801 97.8827107 30.9335509 95.2047438 30.9335509 95.2047438 41.6454132 92.5267768 41.6454132 92.5267768 17.5437245 103.238645 17.5437245 103.238645 6.83186225 111.272543 6.83186225 111.272543 14.8657575 108.594576 14.8657575 108.594576 9.50982642 105.916609 9.50982642 105.916609 20.2216887 95.2047438 20.2216887 95.2047438 28.2555867 108.594576 28.2555867 108.594576 25.5776198 97.8827107 25.5776198 97.8827107 22.8996556 108.594576 22.8996556 108.594576 17.5437245 111.272543 17.5437245 111.272543 30.9335509 100.560675 30.9335509 100.560675 44.3233801 108.594576 44.3233801 108.594576 36.289482 105.916609 36.289482 105.916609 41.6454132 103.238645 41.6454132 103.238645 33.6115179 111.272543 33.6115179 111.272543 47.0013443 89.8488127 47.0013443 89.8488127 60.3911735 127.340339 60.3911735 127.340339 73.7809999 124.662372 73.7809999 124.662372 63.0691376 116.628474 63.0691376 116.628474 68.4250688 105.916609 68.4250688 105.916609 73.7809999 95.2047438 73.7809999 95.2047438 89.8487933 68.4250826 89.8487933 68.4250826 103.23862 71.1030496 103.23862 71.1030496 92.5267574 103.238645 92.5267574 103.238645 89.8487933 97.8827107 89.8487933 97.8827107 76.4589641 108.594576 76.4589641 108.594576 71.1030357 119.306441 71.1030357 119.306441 65.7471046 121.984405 65.7471046 121.984405 76.4589641 138.052204 76.4589641 138.052204 92.5267574 143.408135 92.5267574 143.408135 95.2047244 135.374237 95.2047244 135.374237 79.136931 121.984405 79.136931 121.984405 92.5267574 130.018303 92.5267574 130.018303 84.4928621 127.340339 84.4928621 127.340339 89.8487933 124.662372 89.8487933 124.662372 81.8148952 132.69627 81.8148952 132.69627 95.2047244 119.306441 95.2047244 119.306441 73.7809999 111.272543 73.7809999 111.272543 76.4589641 116.628474 76.4589641 116.628474 79.136931 100.560675 79.136931 100.560675 87.1708263 105.916609 87.1708263 105.916609 95.2047244 73.7810165 95.2047244 73.7810165 103.23862 87.1708457 103.23862 87.1708457 100.560656 76.4589807 100.560656 76.4589807 97.8826886 105.916609 97.8826886 105.916609 111.272518 65.7471157 111.272518 65.7471157 108.594656 92.5267768 108.594656 92.5267768 103.23862 100.560675 103.23862 100.560675 105.916584 95.2047438 105.916584 95.2047438 108.594656 103.238645 108.594656 103.238645 100.560656 89.8488127 100.560656 89.8488127 105.916584 65.7471157 105.916584 65.7471157 87.1708263 92.5267768 87.1708263 92.5267768 73.7809999 60.3911846 73.7809999 60.3911846 68.4250688 47.0013554 68.4250688 47.0013554 79.136931 36.2894904 79.136931 36.2894904 97.8826886 47.0013554 97.8826886 47.0013554 100.560656 33.6115234 100.560656 33.6115234 79.136931 25.5776253 79.1369671 25.5776253 89.8487933 22.8996584 89.8487933 22.8996584 76.4589641 44.3233884 76.4589641 44.3233884 68.4250688 36.2894904 68.4250688 36.2894904 71.1030357 41.6454215 71.1030357 41.6454215 73.7809999 20.2216942 73.7809999 20.2216942 92.5267574 25.5776253 92.5267574 25.5776253 97.8826886 28.2555923 97.8826886 28.2555923 81.8148952 30.9335592 81.8148952 30.9335592 100.560656 22.8996584 100.560656 22.8996584 95.2047244 17.5437273 95.2047244 17.5437273 68.4250688 1.47593112 68.4250688 1.47593112 63.0691376 0 63.069 0 60.391 6.83186225 60.3911735 6.83186225 55.0352424 9.50982919 55.0352424 9.50982919 63.0691376 4.15389807 63.0691376 4.15389807 65.7471046 17.5437273 65.7471046 17.5437273 60.3911735 20.2216942 60.3911735 20.2216942 71.1030357 33.6115234 71.1030357 33.6115234 55.0352424 36.2894904 55.0352424 36.2894904 65.7471046 44.3233884 65.7471046 44.3233884 41.6454132 30.9335592 41.6454132 30.9335592 49.6793112 38.9674573 49.6793112 38.9674573 47.0013443 33.6115234 47.0013443 33.6115234 44.3233801 41.6454215 44.3233801 41.6454215 63.0691376 38.9674573 63.0691376 38.9674573 52.3572754 30.9335592 52.3572754 30.9335592 57.7132065 28.2555923 57.7132065 28.2555923 52.3572754 17.5437273 52.3572754 17.5437273 41.6454132 14.8657603 41.6454132 14.8657603 47.0013443 6.83186225 47.0013443 6.83186225 20.2216887 4.15389807 20.2216887 4.15389807 25.5776198 1.47593112 25.5776198 1.47593112 17.5437245 9.50982919 17.5437245 9.50982919 28.2555867 22.8996584 28.2555867 22.8996584 17.5437245 36.2894904 17.5437245 36.2894904 25.5776198 28.2555923 25.5776198 28.2555923 22.8996916 33.6115234 22.8996916 33.6115234 20.2217247 25.5776253 20.2217247 25.5776253 47.0013443 22.8996584 47.0013443 22.8996584 36.289482 17.5437273 36.289482 17.5437273 33.6115179 22.8996584 33.6115179 22.8996584 30.9335509 9.50982919 30.9335509 9.50982919 44.3233801 12.1877961 44.3233801 12.1877961 33.6115179 14.8657603 33.6115179 14.8657603 38.967449 20.2216942 38.967449 20.2216942 49.6793112 28.2555923 49.6793112 28.2555923 38.967449 47.0013554 38.967449 47.0013554 65.7471046 73.7810165 65.7471046 73.7810165 68.4250688 63.0691515 68.4250688 63.0691515 71.1030357 76.4589807 71.1030357 76.4589807 63.0691376 49.6793195 63.0691376 49.6793195 49.6793112 63.0691515 49.6793112 63.0691515 57.7132065 55.0352534 57.7132065 55.0352534 55.0352424 60.3911846 55.0352424 60.3911846 52.3572754 52.3572865 52.3572754 52.3572865 60.3911735 79.1369476 60.3911735 79.1369476 71.1030357 92.5267768 71.1030357 92.5267768 68.4250688 81.8149146 68.4250688 81.8149146 38.967449 84.4928788 38.967449 84.4928788 65.7471046 95.2047438 65.7471046 95.2047438 71.1030357 103.238645 71.1030357 103.238645 65.7471046 113.950507 65.7471046 113.950507 63.0691376 100.560675 63.0691376 100.560675 68.4250688 97.8827107 68.4250688 97.8827107 63.0691376 87.1708457 63.0691376 87.1708457 36.289482 81.8149146 36.289482 81.8149146 25.5776198 63.0691515 25.5776198 63.0691515 30.9335509 60.3911846 30.9335509 60.3911846 22.8996556 65.7471157 22.8996556 65.7471157 20.2216887 57.7132176 20.2216887 57.7132176 33.6115179 73.7810165 33.6115179 73.7810165 52.3572754 71.1030496 52.3572754 71.1030496 36.289482 68.4250826 36.289482 68.4250826 41.6454132 65.7471157 41.6454132 65.7471157 36.289482 55.0352534 36.289482 55.0352534 17.5437245 65.7471157 17.5437245 65.7471157 12.1877934 71.1030496 12.1877934 71.1030496 6.83186225" />
  <polygon points="150 103.238 150 105.916 143.408135 105.916617 143.408135 108.594656 148.71202 108.594656 148.764077 111.272518 140.730168 111.272518 140.730168 103.23862" />
  <polygon points="150 73.78 146.086088 73.7809999 146.086088 71.1030357 150 71.103" />
  <polygon points="14.8657603 49.6793112 14.8657603 55.0352424 25.5776253 55.0352424 25.5776253 65.7471046 28.2555923 65.7471046 28.2555923 60.3911735 30.9335592 60.3911735 30.9335592 68.4250688 22.8996584 68.4250688 22.8996584 57.7132065 14.8657603 57.7132065 14.8657603 63.0691376 12.1877961 63.0691376 12.1877961 49.6793112" />
  <polygon points="148.764077 55.0352424 150 55.035 150 57.713 140.730168 57.7132065 140.730168 55.0352424 146.086088 55.0352424 146.086088 52.3572754 148.764077 52.3572754" />
  <polygon points="41.645 0 41.6454215 12.1877934 55.0352534 12.1877934 55.0352534 4.1538953 47.0013554 4.1538953 47.0013554 6.83186225 52.3572865 6.83186225 52.3572865 9.50982642 44.3233884 9.50982642 44.3233884 1.47593112 57.7132176 1.47593112 57.7132176 14.8657575 41.6454215 14.8657575 41.6454215 30.9335509 30.9335592 30.9335509 30.9335592 33.6115179 44.3233884 33.6115179 44.3233884 28.2555867 47.0013554 28.2555867 47.0013554 33.6115179 49.6793195 33.6115179 49.6793195 20.2216887 47.0013554 20.2216887 47.0013554 25.5776198 44.3233884 25.5776198 44.3233884 17.5437245 52.3572865 17.5437245 52.3572865 38.967449 63.0691515 38.967449 63.0691515 44.3233801 68.4250826 44.3233801 68.4250826 55.0352424 76.4589807 55.0352424 76.4589807 30.9335509 65.7471157 30.9335509 65.7471157 28.2555867 79.1369476 28.2555867 79.1369476 57.7132065 65.7471157 57.7132065 65.7471157 47.0013443 60.3911846 47.0013443 60.3911846 41.6454132 52.3572865 41.6454132 52.3572865 44.3233801 57.7132176 44.3233801 57.7132176 47.0013443 49.6793195 47.0013443 49.6793195 36.289482 28.2555923 36.289482 28.2555923 28.2555867 38.9674573 28.2555867 38.967 0" />
  <polygon points="4.15389807 28.2555867 4.15389807 49.6793112 9.50982919 49.6793112 9.50982919 52.3572754 4.15389807 52.3572754 4.15389807 57.7132065 1.47593112 57.7132065 1.47593112 28.2555867" />
  <polygon points="150 44.323 150 47.001 148.764077 47.0013443 148.764077 49.6793112 146.086088 49.6793112 146.086088 44.3233801" />
  <polygon points="148.764077 28.2555867 150 28.255 150 30.933 146.086088 30.9335509 146.086088 22.8996556 148.764077 22.8996556" />
  <polygon points="143.408135 1.47593112 143.408135 4.1538953 116.628474 4.1538953 116.628474 12.1877934 143.408135 12.1877934 143.408135 17.5437245 150 17.543 150 20.221 143.408135 20.2216887 143.408135 30.9335509 113.950507 30.9335509 113.950507 28.2555867 135.374237 28.2555867 135.374237 17.5437245 138.052204 17.5437245 138.052204 28.2555867 140.730168 28.2555867 140.730168 14.8657575 132.69627 14.8657575 132.69627 25.5776198 113.950507 25.5776198 113.950507 17.5437245 127.340339 17.5437245 127.340339 20.2216887 116.628474 20.2216887 116.628474 22.8996556 130.018303 22.8996556 130.018303 14.8657575 113.950507 14.8657575 113.950507 4.1538953 103.238645 4.1538953 103.238645 1.47593112" />
  <polygon points="95.2047438 6.83186225 95.2047438 9.50982642 79.1369476 9.50982642 79.1369476 17.5437245 87.1708457 17.5437245 87.1708457 14.8657575 81.8149146 14.8657575 81.8149146 12.1877934 97.8827107 12.1877934 97.8827107 6.83186225 100.560675 6.83186225 100.560675 14.8657575 89.8488127 14.8657575 89.8488127 30.9335509 87.1708457 30.9335509 87.1708457 20.2216887 71.1030496 20.2216887 71.1030496 17.5437245 76.4589807 17.5437245 76.4589807 6.83186225" />
  <polygon points="14.865 0 14.8657603 6.83186225 22.8996584 6.83186225 22.8996584 4.1538953 17.5437273 4.1538953 17.5437273 1.47593112 36.2894904 1.47593112 36.2894904 14.8657575 33.6115234 14.8657936 33.6115234 4.1538953 25.5776253 4.1538953 25.5776253 12.1877934 28.2555923 12.1877934 28.2555923 6.83186225 30.9335592 6.83186225 30.9335592 14.8657575 22.8996584 14.8657575 22.8996584 9.50982642 14.8657603 9.50982642 14.8657603 22.8996556 17.5437273 22.8996556 17.5437273 12.1877934 20.2216942 12.1877934 20.2216942 25.5776198 12.1877961 25.5776198 12.187 0" />
  <polygon points="9.50982919 12.1877934 9.50982919 14.8657575 0 14.865 0 12.187" />
  <polygon points="148.764 0 148.764077 14.8657575 146.086088 14.8657575 146.086088 9.50982642 119.306441 9.50982642 119.306441 6.83186225 146.086088 6.83186225 146.086 0" />
  <polygon points="63.069 0 63.0691515 6.83186225 65.7471157 6.83186225 65.7471157 1.47593112 68.4250826 1.47593112 68.4250826 9.50982642 63.0691515 9.50982642 63.0691515 14.8657575 60.3911846 14.8657575 60.391 0" />
  <polygon points="9.50982919 1.47593112 9.50982919 9.50982642 -1.77635684e-15 9.509 -1.77635684e-15 6.831 6.83186225 6.83186225 6.83186225 4.1538953 1.47593112 4.1538953 1.47593112 1.47593112" />
  <polygon points="100.56 0 100.560675 4.1538953 97.8827107 4.1538953 97.882 0" />
  <polygon points="95.2047438 4.1538953 95.2047438 6.83186225 92 6.83186225 92 4.1538953" />
  <polygon points="100.560675 4.1538953 100.560675 6.83186225 97.882 6.83186225 97.882 4.1538953" />
  <polygon points="73.781 0 73.7810165 1.47593112 95.2047438 1.47593112 95.2047438 4.1538953 71.1030496 4.1538953 71.103 0" />
</g>

<g id="m" class="cf0" stroke="none">
  <polygon points="0 0 0 72 109 0" />
  <polygon points="0 285 0 326 375 110 375 247 0 464 0 505 87 454 87 525 125 525 125 434 411 269 411 131 624 254 624 525 663 525 663 234 411 93 562 0 493 0" />
  <polygon points="749 56 749 438 719 456 719 75" />
  <polygon points="344 525 344 506 375 488 406 506 406 525" />
  <polygon points="153 525 375 397 597 525 523 525 375 441 229 525" />
</g>

<?php
}

function half_x_labyrinth() {
  $sx = 0.955;
  $sy = 0.95;
  $mx = (CARD_CUT_LINE_W - (CARD_CUT_LINE_W * $sx)) / 2;
  $my = (CARD_CUT_LINE_H - (CARD_CUT_LINE_H * $sy));
  printf('<g transform="scale(%s,%s) translate(%s,%s)"></g><g>',
    $sx, $sy, $mx, $my );
  print('<use href="#m" />');
  // print('<rect x="0" y="0" width="750" height="525" fill="none" stroke="red" stroke-width="1" />' );
  print('</g>');
}

function half_1_labyrinth($card = 1) {
  $w = $h = 150;
  $svg = '';
  for ($i = 0; $i < 5; $i++) {
    for ($j = 0; $j < 7; $j++) {
      $x1 = $i * $w;
      $y1 = $j * $h;
      $svg .= sprintf('<g transform="translate(%s,%s)">', $x1, $y1 );
      $xtra = '';

      if (($i % 2) == 0) {
        $q = (($j % 2) == 0) ? 1 : 3;
      } else {
        $q = (($j % 2) == 0) ? 2 : 4;
      }

      switch ($q) {
        case 2: $xtra .= ' transform="translate('.$w.',0) scale(-1,1)"'; break;
        case 3: $xtra .= ' transform="translate(0,'.$h.') scale(1,-1)"'; break;
        case 4: $xtra .= ' transform="translate('.$w.','.$h.') scale(-1,-1)"'; break;
      }
      $svg .= '<!-- Q' . $q . ' --><use href="#b"' . $xtra . ' /></g>';
    }
  }
  print $svg;
  half_x_labyrinth();
}

function half_2_labyrinth($card = 1) {
  half_x_labyrinth();
}
